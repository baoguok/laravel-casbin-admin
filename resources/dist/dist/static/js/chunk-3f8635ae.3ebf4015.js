(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3f8635ae"],{"275f":function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("treeselect",{attrs:{multiple:!1,options:e.nodes,normalizer:e.normalizer},model:{value:e.valueId,callback:function(t){e.valueId=t},expression:"valueId"}})],1)},o=[],i=n("ca17"),a=n.n(i),s=(n("542c"),{components:{Treeselect:a.a},props:["nodes","value"],data:function(){return{valueId:0,node:{id:0,name:null,title:null,label:null},normalizer:function(e){return{id:e.id,label:e.title,children:e.children}}}},mounted:function(){this.valueId=this.value?this.value:0},watch:{valueId:function(e){this.$emit("setId",this.valueId)}}}),l=s,u=n("2877"),c=Object(u["a"])(l,r,o,!1,null,null,null);t["a"]=c.exports},3786:function(e,t,n){"use strict";n.r(t),n.d(t,"addUser",(function(){return o})),n.d(t,"getPermissionList",(function(){return i})),n.d(t,"getAllPermissions",(function(){return a})),n.d(t,"getUserList",(function(){return s})),n.d(t,"addPermissions",(function(){return l})),n.d(t,"updatePermissions",(function(){return u})),n.d(t,"delPermissions",(function(){return c})),n.d(t,"updateUser",(function(){return d})),n.d(t,"getLogList",(function(){return m})),n.d(t,"delLog",(function(){return f}));var r=n("b775");function o(e){return Object(r["a"])({url:"/admin/users",method:"post",data:e})}function i(e){return Object(r["a"])({url:"/admin/permissions",method:"get",data:{id:e}})}function a(){return Object(r["a"])({url:"/admin/all_permissions",method:"get"})}function s(e){return Object(r["a"])({url:"/admin/users",method:"get",params:e})}function l(e){return Object(r["a"])({url:"/admin/permissions",method:"post",data:e})}function u(e){return Object(r["a"])({url:"/admin/permissions/"+e.id,method:"put",data:e})}function c(e){return Object(r["a"])({url:"/admin/permissions/"+e,method:"delete"})}function d(e){return Object(r["a"])({url:"/admin/users/"+e.id,method:"put",data:e})}function m(e){return Object(r["a"])({url:"/admin/log",method:"get",params:e})}function f(e){return Object(r["a"])({url:"/admin/log/"+e,method:"delete"})}},b9e5:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container "},[n("div",{staticClass:"filter-container"},[n("el-form",[n("el-form-item",[n("el-button",{attrs:{type:"success",icon:"el-icon-plus"},on:{click:e.add}})],1)],1)],1),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticClass:"content-container"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.list,border:"","tree-props":{children:"children",hasChildren:"hasChildren"},"row-key":"id"}},[n("el-table-column",{attrs:{prop:"name",label:"权限名称"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[1==r.is_menu?n("i",{staticClass:"fa fa-reorder"}):n("i",{staticClass:"fa fa-paper-plane"}),n("span",[e._v(" "+e._s(r.name))])]}}])}),n("el-table-column",{attrs:{prop:"status",label:"权限状态"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[1==r.status?n("el-tag",[e._v("正常")]):n("el-tag",[e._v("禁用")])]}}])}),n("el-table-column",{attrs:{prop:"url",label:"url"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[n("el-tag",[n("span",[e._v(e._s(r.url))])])]}}])}),n("el-table-column",{attrs:{prop:"icon",label:"icon"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[n("i",{class:t.icon})]}}])}),n("el-table-column",{attrs:{prop:"path",label:"前端路由"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[n("el-tag",[n("span",[e._v(e._s(r.path))])])]}}])}),n("el-table-column",{attrs:{prop:"method",label:"方法"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[n("el-tag",[e._v(e._s(r.method.toUpperCase()))])]}}])}),n("el-table-column",{attrs:{label:"操作",width:"250px"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[n("el-button",{attrs:{type:"primary",icon:"el-icon-edit-outline"},on:{click:function(t){return e.edit(r)}}}),n("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.del(r)}}})]}}])})],1)],1),n("el-dialog",{attrs:{title:e.title,visible:e.dialogVisible,"before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.dialogVisible?n("el-form",{ref:"roleForm",attrs:{model:e.form,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"是否为菜单"}},[n("el-radio-group",{model:{value:e.form.is_menu,callback:function(t){e.$set(e.form,"is_menu",t)},expression:"form.is_menu"}},[n("el-radio-button",{attrs:{label:!0}},[e._v("是")]),n("el-radio-button",{attrs:{label:!1}},[e._v("否")])],1)],1),n("el-form-item",{attrs:{label:"权限名称: ",required:!0,prop:"name"}},[n("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"后端api: ",required:!0,prop:"url"}},[n("el-input",{model:{value:e.form.url,callback:function(t){e.$set(e.form,"url",t)},expression:"form.url"}})],1),e.form.is_menu?n("el-form-item",{attrs:{label:"前端路由: ",required:!0,prop:"path"}},[n("el-input",{model:{value:e.form.path,callback:function(t){e.$set(e.form,"path",t)},expression:"form.path"}})],1):e._e(),e.form.is_menu?n("el-form-item",{attrs:{label:"icon"}},[n("e-icon-picker",{attrs:{prop:"icon"},model:{value:e.form.icon,callback:function(t){e.$set(e.form,"icon",t)},expression:"form.icon"}})],1):e._e(),e.form.is_menu?e._e():n("el-form-item",{attrs:{label:"方法选择: ",required:!0,prop:"method"}},[n("el-radio",{attrs:{label:"POST",border:""},model:{value:e.form.method,callback:function(t){e.$set(e.form,"method",t)},expression:"form.method"}}),n("el-radio",{attrs:{label:"GET",border:""},model:{value:e.form.method,callback:function(t){e.$set(e.form,"method",t)},expression:"form.method"}}),n("el-radio",{attrs:{label:"*",border:""},model:{value:e.form.method,callback:function(t){e.$set(e.form,"method",t)},expression:"form.method"}}),n("el-radio",{attrs:{label:"PUT",border:""},model:{value:e.form.method,callback:function(t){e.$set(e.form,"method",t)},expression:"form.method"}}),n("el-radio",{attrs:{label:"DELETE",border:""},model:{value:e.form.method,callback:function(t){e.$set(e.form,"method",t)},expression:"form.method"}})],1),n("el-form-item",{attrs:{label:"请选择父菜单: "}},[e.dialogVisible?n("SelectTree",{attrs:{props:e.defaultProps,nodes:e.permissions,value:e.checkedPermission},on:{setId:function(t){return e.setId(t)}}}):e._e()],1),n("el-form-item",[n("el-button",{on:{click:e.submit}},[e._v("提交")])],1)],1):e._e()],1)],1)},o=[],i=(n("99af"),n("b0c0"),n("d3b7"),n("25f0"),n("96cf"),n("1da1")),a=n("275f"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-tree",{attrs:{data:e.data,props:e.defaultProps},on:{"node-click":e.handleNodeClick}})},l=[],u={props:{},watch:{defaultProps:function(){alert(22)}},data:function(){return{data:[{label:"一级 1",children:[{label:"二级 1-1",children:[{label:"三级 1-1-1"}]}]}],defaultProps:{children:"children",label:"label"}}},methods:{handleNodeClick:function(e){alert(2)}}},c=u,d=n("2877"),m=Object(d["a"])(c,s,l,!1,null,null,null),f=m.exports,p=n("3786"),h={name:"PagePermission",components:{SelectTree:a["a"],showTree:f},data:function(){return{list:[],listLoading:!1,dialogVisible:!1,title:void 0,form:{name:void 0,title:void 0,icon:void 0,path:void 0,method:"*",id:void 0,p_id:0,root:!1,hidden:"1",url:void 0,is_menu:1},permissions:[],beforeClose:!0,checkedPermission:void 0,defaultProps:{children:"children",label:"name"}}},methods:{handleClose:function(e){this.$confirm("确认关闭？").then((function(t){e()})).catch((function(e){}))},getList:function(e){var t=this;Object(p["getPermissionList"])(e).then((function(e){var n=e.data;t.list=n.list}))},submit:function(){var e=this;void 0!=this.form.id?Object(p["updatePermissions"])(this.form).then((function(t){e.$message.success("success"),e.dialogVisible=!1,e.getList()})):Object(p["addPermissions"])(this.form).then((function(t){e.$message.success("success"),e.dialogVisible=!1,e.getList()}))},add:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.title="新增权限节点",e.form=e.$options.data().form,e.form.is_menu=!1,t.next=5,e.setFormPermissionTree();case 5:e.dialogVisible=!0;case 6:case"end":return t.stop()}}),t)})))()},edit:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return console.log(e.root),n.next=3,t.setFormPermissionTree();case 3:t.form=Object.assign(t.form,e,{method:e.method.toUpperCase(),root:0==e.p_id,hidden:e.hidden.toString(),is_menu:e.is_menu}),t.checkedPermission=e.p_id,t.permissionTitle=e.name,t.title="编辑权限 | "+e.name,t.dialogVisible=!0;case 8:case"end":return n.stop()}}),n)})))()},del:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.$confirm("此操作将永久删除权限, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(p["delPermissions"])(e.id).then((function(e){t.$message({type:"success",message:"删除成功!"}),t.getList()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}));case 1:case"end":return n.stop()}}),n)})))()},setId:function(e){this.form.p_id=e},setFormPermissionTree:function(e){var t=this;new Promise((function(e,n){Object(p["getAllPermissions"])().then((function(n){var r=n.data,o=[{id:0,name:"根节点",title:"根节点"}];o=o.concat(r.list),t.$set(t,"permissions",o),e(!0)}))}))},handleRolesChange:function(){this.$router.push({path:"/permission/index?"+ +new Date})}},mounted:function(){this.getList()}},b=h,v=Object(d["a"])(b,r,o,!1,null,null,null);t["default"]=v.exports}}]);